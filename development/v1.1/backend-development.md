# Titan V1.1 | åç«¯å¼€å‘æ¸…å• - ASMRéŸ³é¢‘ä¼˜å…ˆæ¶æ„

åŸºäº [PRD V1.1](../../requirements/PRD-v1.1.md) çš„ä¸“ä¸šASMRéŸ³é¢‘ç”Ÿäº§ä¸åˆ†å‘å¹³å°åç«¯å¼€å‘ä»»åŠ¡ã€‚

**ğŸ§ é‡å¤§æ¶æ„æ›´æ–°**: åŸºäºç”¨æˆ·åé¦ˆå’Œzenä¸“å®¶åˆ†æï¼Œç³»ç»Ÿå·²ä»è§†é¢‘ä¼˜å…ˆè½¬å‘**ASMRéŸ³é¢‘ä¼˜å…ˆæ¶æ„**ã€‚è¯¦æƒ…å‚è§ [éœ€æ±‚å˜æ›´å• CR-2025-001](../../requirements/change-requests/CR-2025-001-ASMR-Audio-Priority-Architecture.md)

## ğŸ“‹ å¼€å‘æ¦‚è§ˆ

- **ç‰ˆæœ¬**: V1.1.1 (ASMRéŸ³é¢‘ä¼˜å…ˆ)
- **æŠ€æœ¯æ ˆ**: NestJS + MikroORM + PostgreSQL + Redis + ElevenLabs AI + ElevenLabs Sound Effects API
- **æ ¸å¿ƒç›®æ ‡**: å®ç°ä»æ–‡æœ¬åˆ°é«˜è´¨é‡ASMRéŸ³é¢‘ç”Ÿæˆå†åˆ°å¤šå¹³å°åˆ†å‘çš„å®Œæ•´åç«¯æ”¯æŒ
- **å…³é”®èƒ½åŠ›**: AIè¯­éŸ³åˆæˆã€AIéŸ³æ™¯ç”Ÿæˆã€ä¸“ä¸šéŸ³é¢‘æ··åˆã€åŒè€³éŸ³é¢‘å¤„ç†ã€ASMRè´¨é‡ä¼˜åŒ–

## ğŸ¯ å¼€å‘çŠ¶æ€æ€»è§ˆ

**ğŸ“Š æ•´ä½“è¿›åº¦**: âœ… **å·²å®Œæˆæ ¸å¿ƒæ¶æ„å®ç°ï¼Œç³»ç»Ÿå·²è¾¾ç”Ÿäº§å°±ç»ªæ ‡å‡†**

**ğŸ”¥ é‡å¤§é‡Œç¨‹ç¢‘**:

- âœ… **AIéŸ³é¢‘æ ¸å¿ƒå¼•æ“**ï¼šElevenLabs + Sound Effects APIå®Œæ•´é›†æˆ
- âœ… **ä¸“ä¸šASMRå¤„ç†**ï¼šFFmpegéŸ³é¢‘æ··åˆã€åŒè€³æ•ˆæœã€è´¨é‡ä¼˜åŒ–
- âœ… **å¼‚æ­¥ä»»åŠ¡ç³»ç»Ÿ**ï¼šBullMQä¸‰é˜Ÿåˆ—æ¶æ„ï¼Œå®Œæ•´é”™è¯¯å¤„ç†
- âœ… **ä¸­è€å¹´äººä¼˜åŒ–**ï¼šä¸“ä¸šåŒ–ASMRå‚æ•°è°ƒä¼˜
- âš ï¸ **æŠ€æœ¯å€ºåŠ¡æœ€å°åŒ–**ï¼šä»…å‰©é…ç½®æ–‡æ¡£å’Œç›‘æ§æŒ‡æ ‡ï¼ˆä¸­ç­‰ä¼˜å…ˆçº§ï¼‰

**ğŸ† Zen Expert Analysis ç»“æœ**:

> ç³»ç»Ÿæ¶æ„å·²è¾¾åˆ°**å•†ä¸šçº§ASMRéŸ³é¢‘ç”Ÿæˆå¹³å°æ ‡å‡†**ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ä¸­è€å¹´äººçš„ä¼˜åŒ–å’ŒElevenLabs APIé›†æˆå®ç°ï¼Œå±•ç°äº†æ·±åº¦çš„é¢†åŸŸä¸“ä¸šçŸ¥è¯†ã€‚ç³»ç»Ÿå·²å‡†å¤‡å¥½ç”Ÿäº§éƒ¨ç½²ã€‚

## ğŸ¯ æ¶æ„å˜æ›´å¯¹æ¯”

| æ–¹é¢           | åŸæ¶æ„ (è§†é¢‘ä¼˜å…ˆ)      | æ–°æ¶æ„ (ASMRéŸ³é¢‘ä¼˜å…ˆ)                    |
| -------------- | ---------------------- | ---------------------------------------- |
| **æ ¸å¿ƒå¤„ç†**   | FFmpegè§†é¢‘åˆæˆ         | ElevenLabs + Soundverse + FFmpegéŸ³é¢‘æ··åˆ |
| **ä¸»è¦å·¥ä½œæµ** | ç´ æâ†’è§†é¢‘æ¨¡æ¿â†’è§†é¢‘åˆæˆ | æ–‡æœ¬â†’AIè¯­éŸ³â†’AIéŸ³æ™¯â†’ä¸“ä¸šæ··éŸ³              |
| **è´¨é‡é‡ç‚¹**   | è§†é¢‘åˆ†è¾¨ç‡ã€è§†è§‰æ•ˆæœ   | éŸ³é¢‘é‡‡æ ·ç‡ã€ASMRè§¦å‘æ•ˆæœã€åŒè€³å¤„ç†       |
| **æŠ€æœ¯éš¾ç‚¹**   | è§†é¢‘ç¼–è§£ç ã€ç‰¹æ•ˆæ¸²æŸ“   | AIæœåŠ¡é›†æˆã€éŸ³é¢‘è´¨é‡ä¼˜åŒ–ã€å®æ—¶å¤„ç†       |

---

## ğŸ—ï¸ Milestone 1: åŸºç¡€æ¶æ„ä¸æ•°æ®æ¨¡å‹ âœ… **å·²å®Œæˆ**

### 1.1 æ•°æ®åº“æ¶æ„æ‰©å±• âœ…

#### æ–°å¢å®ä½“è®¾è®¡ âœ… **å®Œæˆ**

- [x] **æ‰©å±• User å®ä½“** âœ…

  ```typescript
  // æ–°å¢å­—æ®µ
  wechatVideoChannelId?: string;  // å¾®ä¿¡è§†é¢‘å·ID
  subscriptionPlan: string;       // è®¢é˜…è®¡åˆ’
  contentQuota: number;          // å†…å®¹é…é¢
  ```

- [x] **Asset å®ä½“** - ç´ æç®¡ç†æ ¸å¿ƒ âœ…

  ```typescript
  id: string;
  userId: string;               // å…³è”ç”¨æˆ·
  fileName: string;             // æ–‡ä»¶å
  originalName: string;         // åŸå§‹æ–‡ä»¶å
  filePath: string;            // æ–‡ä»¶è·¯å¾„
  fileSize: number;            // æ–‡ä»¶å¤§å°
  mimeType: string;            // MIMEç±»å‹
  assetType: AssetType;        // ç´ æç±»å‹æšä¸¾
  tags: string[];              // æ ‡ç­¾æ•°ç»„
  description?: string;        // æè¿°
  metadata: object;            // å…ƒæ•°æ®(æ—¶é•¿ã€åˆ†è¾¨ç‡ç­‰)
  uploadSource: UploadSource;  // ä¸Šä¼ æ¥æº(æœ¬åœ°/é˜¿é‡Œäº‘ç›˜)
  createdAt: Date;
  updatedAt: Date;
  ```

- [x] **Project å®ä½“** - é¡¹ç›®ç®¡ç† âœ…

  ```typescript
  id: string;
  userId: string;
  name: string;
  description?: string;
  status: ProjectStatus;       // è¿›è¡Œä¸­/å·²å®Œæˆ/å·²æš‚åœ
  assetCount: number;         // å…³è”ç´ ææ•°é‡
  contentCount: number;       // ç”Ÿæˆå†…å®¹æ•°é‡
  createdAt: Date;
  updatedAt: Date;
  ```

- [x] **ProjectAsset å®ä½“** - é¡¹ç›®ç´ æå…³è” âœ…

- [x] **ContentTemplate å®ä½“** - å†…å®¹æ¨¡æ¿ âœ…

- [x] **ContentJob å®ä½“** - å†…å®¹ç”Ÿäº§ä»»åŠ¡ âœ…

  ```typescript
  // å·²æ‰©å±•æ”¯æŒASMRé…ç½®
  asmrConfig?: {
    voiceSettings: VoiceOptions;
    soundscapeConfig: SoundscapeOptions;
    mixingSettings: MixingOptions;
    qualityRequirements: QualityRequirements;
  };
  aiCostEstimate?: number;
  actualAiCost?: number;
  qualityReport?: AudioQualityReport;
  ```

- [x] **GeneratedContent å®ä½“** - ç”Ÿæˆçš„å†…å®¹ âœ…

- [x] **PublishSchedule å®ä½“** - å‘å¸ƒæ’æœŸ âœ…

#### æ•°æ®åº“è¿ç§» âœ…

- [x] åˆ›å»ºæ–°å®ä½“çš„è¿ç§»è„šæœ¬ âœ…
- [x] è®¾è®¡ç´¢å¼•ç­–ç•¥(userId, status, createdAtç­‰) âœ…
- [x] è®¾ç½®å¤–é”®çº¦æŸå’Œçº§è”åˆ é™¤è§„åˆ™ âœ…
- [x] æµ‹è¯•è¿ç§»è„šæœ¬çš„å›æ»šåŠŸèƒ½ âœ…

### 1.2 æšä¸¾å®šä¹‰ âœ…

- [x] **AssetType æšä¸¾** âœ…
- [x] **å…¶ä»–å…³é”®æšä¸¾** âœ…
  ```typescript
  enum ProjectStatus, JobType, JobStatus,
  PublishStatus, ScheduleStatus, UploadSource
  ```

### 1.3 ç¯å¢ƒé…ç½®æ›´æ–° - ASMRéŸ³é¢‘ä¼˜å…ˆ âœ…

- [x] **AIæœåŠ¡ç¯å¢ƒå˜é‡** âœ…

  ```bash
  # ElevenLabs AIè¯­éŸ³åˆæˆ âœ…
  ELEVENLABS_API_KEY=your_elevenlabs_api_key
  ELEVENLABS_BASE_URL=https://api.elevenlabs.io

  # ElevenLabs Sound Effects API (æ›¿æ¢Soundverse) âœ…
  ELEVENLABS_SOUND_EFFECTS_ENDPOINT=/v1/text-to-sound-effects

  # ASMRéŸ³é¢‘å¤„ç†ä¼˜åŒ– âœ…
  FFMPEG_PATH=/usr/bin/ffmpeg
  AUDIO_TEMP_DIR=/tmp/titan/audio
  AUDIO_OUTPUT_DIR=./uploads/audio
  MAX_CONCURRENT_AUDIO_JOBS=5

  # Redis (AIéŸ³é¢‘ä»»åŠ¡é˜Ÿåˆ—) âœ…
  REDIS_HOST=localhost
  REDIS_PORT=6379
  REDIS_AUDIO_QUEUE_DB=1

  # ASMRè´¨é‡æ§åˆ¶ âœ…
  ASMR_MIN_QUALITY_SCORE=4.0
  ASMR_AUTO_RETRY_FAILED_JOBS=true
  ```

---

## ğŸ§ Milestone 2: AIéŸ³é¢‘å¤„ç†æ ¸å¿ƒæ¨¡å— âœ… **å·²å®Œæˆ**

**ğŸ¯ æ ¸å¿ƒæˆæœ**: å®Œæ•´å®ç°äº†ä¸“ä¸šçº§ASMRéŸ³é¢‘ç”Ÿæˆå¼•æ“ï¼ŒåŒ…æ‹¬ElevenLabsè¯­éŸ³åˆæˆã€Sound EffectséŸ³æ™¯ç”Ÿæˆã€FFmpegä¸“ä¸šæ··éŸ³å¤„ç†ã€‚

### 2.1 AIéŸ³é¢‘æœåŠ¡é›†æˆæ¨¡å— (AIAudioModule) âœ…

#### 2.1.1 ElevenLabsè¯­éŸ³åˆæˆæœåŠ¡ âœ…

##### æ¥å£è®¾è®¡ âœ…

- [x] **åˆ›å»ºIAudioProvideræ¥å£** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/ai-audio/interfaces/audio-provider.interface.ts`
  - å®ç°ï¼šå®šä¹‰è¯­éŸ³åˆæˆç»Ÿä¸€æ¥å£

  ```typescript
  interface IAudioProvider {
  	generateVoice(text: string, options: VoiceOptions): Promise<VoiceGenerationResult>;
  	getVoices(): Promise<Voice[]>;
  	cloneVoice(audioSample: Buffer, name: string): Promise<VoiceCloneResult>;
  	getVoiceById(voiceId: string): Promise<Voice>;
  	estimateCost(text: string, options: VoiceOptions): Promise<number>;
  	validateConnection(): Promise<boolean>;
  }
  ```

- [x] **å®ç°ElevenLabsProvideræœåŠ¡** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/ai-audio/providers/elevenlabs.provider.ts`
  - ğŸ† **ä¸“ä¸šçº§å®ç°ç‰¹ç‚¹**:
    - âœ… å®Œæ•´çš„axios HTTPå®¢æˆ·ç«¯é›†æˆ
    - âœ… å…¨é¢çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç æ˜ å°„
    - âœ… ASMRä¼˜åŒ–é…ç½®é¢„è®¾
    - âœ… æˆæœ¬è·Ÿè¸ªå’Œä½¿ç”¨é‡ç›‘æ§
    - âœ… è¯­éŸ³é€‚é…åº¦è‡ªåŠ¨æ ‡è®°

##### ASMRè¯­éŸ³ä¼˜åŒ–é…ç½® âœ…

- [x] **ASMRä¸“ç”¨è¯­éŸ³é¢„è®¾** âœ… **å·²å®ç°**
  ```typescript
  // é’ˆå¯¹ä¸­è€å¹´äººASMRä¼˜åŒ–çš„é¢„è®¾
  const ELDERLY_FRIENDLY = {
  	stability: 0.85, // é«˜ç¨³å®šæ€§
  	similarityBoost: 0.9, // é«˜ä¸€è‡´æ€§
  	style: 0.1, // ä½é£æ ¼å¼ºåº¦ï¼Œæ›´è‡ªç„¶
  	speakerBoost: true, // å¢å¼ºè¯´è¯è€…ç‰¹å¾
  };
  ```

#### 2.1.2 ElevenLabs Sound EffectséŸ³æ™¯ç”ŸæˆæœåŠ¡ âœ…

**ğŸ”„ é‡å¤§æŠ€æœ¯æ›´æ–°**: æˆåŠŸä»è™šå‡Soundverse APIæ›¿æ¢ä¸ºçœŸå®ElevenLabs Sound Effects API

##### æ¥å£è®¾è®¡ âœ…

- [x] **åˆ›å»ºISoundscapeProvideræ¥å£** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/ai-audio/interfaces/soundscape-provider.interface.ts`

- [x] **å®ç°ElevenLabsSoundscapeProvideræœåŠ¡** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/ai-audio/providers/soundverse.provider.ts`
  - ğŸ† **æŠ€æœ¯çªç ´ç‰¹ç‚¹**:
    - âœ… **æ™ºèƒ½åˆ†å—å¤„ç†**: 22ç§’é™åˆ¶çš„è‡ªåŠ¨åˆ†æ®µç”Ÿæˆå’Œæ— ç¼æ‹¼æ¥
    - âœ… **ä¸­è€å¹´äººä¼˜åŒ–**: é’ˆå¯¹å¬åŠ›ç‰¹ç‚¹çš„æç¤ºè¯ä¼˜åŒ–å’Œå¼ºåº¦æ§åˆ¶
    - âœ… **å¤‡ç”¨æ–¹æ¡ˆ**: generateFallbackSoundscapeä¿è¯ç³»ç»ŸéŸ§æ€§
    - âœ… **æˆæœ¬æ§åˆ¶**: ç²¾ç¡®çš„æŒ‰æ—¶é•¿è®¡è´¹ä¼°ç®—

##### ASMRéŸ³æ™¯é¢„è®¾ âœ…

- [x] **ASMRéŸ³æ™¯æ¨¡æ¿åº“** âœ… **å·²å®ç°**
  ```typescript
  export const ASMRSoundscapeTemplates = {
  	RAIN_FOREST: {
  		prompt: 'Gentle rain falling on leaves, very peaceful and calming for relaxation',
  		category: 'nature',
  		intensity: 3, // ä¸­è€å¹´äººå‹å¥½å¼ºåº¦
  		duration: 300,
  	},
  	// ... å…¶ä»–ä¸“ä¸šåŒ–æ¨¡æ¿
  };
  ```

#### 2.1.3 FFmpegéŸ³é¢‘æ··åˆæœåŠ¡ âœ…

##### ä¸“ä¸šéŸ³é¢‘å¤„ç† âœ…

- [x] **åˆ›å»ºIAudioMixeræ¥å£** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/ai-audio/interfaces/audio-mixer.interface.ts`

- [x] **å®ç°FFmpegAudioMixeræœåŠ¡** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/ai-audio/services/ffmpeg-audio-mixer.service.ts`
  - ğŸ† **ä¸“ä¸šéŸ³é¢‘å¤„ç†ç‰¹ç‚¹**:
    - âœ… **ASMRä¼˜åŒ–é“¾**: é«˜é€šæ»¤æ³¢â†’ä½é€šæ»¤æ³¢â†’åŠ¨æ€èŒƒå›´å‹ç¼©â†’æ··å“â†’éŸ³é‡æ ‡å‡†åŒ–
    - âœ… **åŒè€³éŸ³é¢‘å¤„ç†**: ç«‹ä½“å£°å®½åº¦è°ƒæ•´å’Œå»¶è¿Ÿæ•ˆæœ
    - âœ… **è´¨é‡åˆ†æ**: åŸºäºffprobeçš„è¯¦ç»†éŸ³é¢‘è´¨é‡è¯„ä¼°
    - âœ… **æ ¼å¼è½¬æ¢**: æ”¯æŒMP3/WAV/AACå¤šç§è¾“å‡ºæ ¼å¼

##### ASMRæ··éŸ³é…ç½® âœ…

- [x] **ASMRæ··éŸ³é¢„è®¾** âœ… **å·²å®ç°**
  ```typescript
  export const ASMRMixingPresets = {
  	ELDERLY_FRIENDLY: {
  		voiceVolume: 0.7,
  		soundscapeVolume: 0.3,
  		fadeInDuration: 3, // é•¿æ·¡å…¥é¿å…çªç„¶å˜åŒ–
  		fadeOutDuration: 5, // é•¿æ·¡å‡º
  		eqSettings: {
  			lowFreq: -2, // å‡å°‘ä½é¢‘å™ªéŸ³
  			midFreq: 1, // å¢å¼ºäººå£°æ¸…æ™°åº¦
  			highFreq: -1, // æŸ”å’Œé«˜é¢‘
  		},
  	},
  };
  ```

### 2.2 ASMRå†…å®¹ç”Ÿäº§ç®¡ç†æ¨¡å— âœ…

#### 2.2.1 ASMRä»»åŠ¡ç®¡ç†æœåŠ¡ âœ…

- [x] **æ‰©å±•ContentJobå®ä½“æ”¯æŒASMR** âœ… **å·²å®ç°**

- [x] **åˆ›å»ºASMRContentService** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/ai-audio/services/asmr-content.service.ts`
  - ğŸ† **ä¸šåŠ¡é€»è¾‘ç‰¹ç‚¹**:
    - âœ… **8æ­¥ASMRç”Ÿæˆæµç¨‹**: è¯­éŸ³ç”Ÿæˆâ†’éŸ³æ™¯ç”Ÿæˆâ†’æ··éŸ³â†’åŒè€³æ•ˆæœâ†’ASMRä¼˜åŒ–â†’è´¨é‡éªŒè¯â†’é‡è¯•é€»è¾‘â†’æ ¼å¼è½¬æ¢
    - âœ… **ä¸­è€å¹´äººä¸“é—¨ä¼˜åŒ–**: optimizeRequestForElderlyæ–¹æ³•
    - âœ… **æ‰¹é‡å¤„ç†**: æ”¯æŒå¹¶å‘æ§åˆ¶çš„æ‰¹é‡ç”Ÿæˆ
    - âœ… **æˆæœ¬æ§åˆ¶**: å®Œå–„çš„æˆæœ¬ä¼°ç®—å’Œè´¨é‡éªŒè¯ç³»ç»Ÿ

#### 2.2.2 ASMRè´¨é‡è¯„ä¼°æœåŠ¡ âœ…

- [x] **åˆ›å»ºAudioQualityService** âœ… **å·²é›†æˆåˆ°FFmpegAudioMixer**
  - ğŸ† **è´¨é‡è¯„ä¼°ç‰¹ç‚¹**:
    - âœ… åŸºäºffprobeçš„æŠ€æœ¯æŒ‡æ ‡åˆ†æ
    - âœ… ASMRä¸“é—¨è¯„åˆ†ç®—æ³•
    - âœ… é’ˆå¯¹ä¸­è€å¹´äººçš„è´¨é‡æ ‡å‡†

##### è´¨é‡è¯„ä¼°æŒ‡æ ‡ âœ…

- [x] **ASMRè´¨é‡æ ‡å‡†å®šä¹‰** âœ… **å·²å®ç°**
  ```typescript
  interface AudioQualityReport {
  	overallScore: number; // 1-10åˆ†
  	asmrMetrics: {
  		voiceClarity: number;
  		soundscapeHarmony: number;
  		binauralEffectiveness: number;
  		relaxationPotential: number;
  	};
  	recommendations: string[];
  	needsReprocessing: boolean;
  }
  ```

### 2.3 å¼‚æ­¥ä»»åŠ¡å¤„ç†æ¶æ„ âœ…

#### 2.3.1 BullMQä»»åŠ¡é˜Ÿåˆ—é›†æˆ âœ…

- [x] **ContentJobServiceéŸ³é¢‘ä»»åŠ¡åˆ›å»º** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/content-job/content-job.service.ts`
  - ğŸ† **ä»»åŠ¡ç®¡ç†ç‰¹ç‚¹**:
    - âœ… ä¸‰ç§éŸ³é¢‘ç”Ÿæˆä»»åŠ¡ï¼šcreateASMRAudioJob, createVoiceGenerationJob, createSoundscapeGenerationJob
    - âœ… å®Œæ•´çš„æ•°æ®åº“è®°å½•åˆ›å»ºå’ŒçŠ¶æ€ç®¡ç†
    - âœ… é‡è¯•æœºåˆ¶ï¼š2æ¬¡é‡è¯•ï¼ŒæŒ‡æ•°é€€é¿ç­–ç•¥

- [x] **AudioGenerationConsumerå¼‚æ­¥å¤„ç†å™¨** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/content-job/processors/audio-generation.processor.ts`
  - ğŸ† **å¤„ç†å™¨ç‰¹ç‚¹**:
    - âœ… ä¸‰ä¸ªä¸“é—¨å¤„ç†å™¨ï¼š@Process('generate-asmr'), @Process('generate-voice'), @Process('generate-soundscape')
    - âœ… å®Œæ•´çš„è¿›åº¦è·Ÿè¸ªï¼šjob.progress()è°ƒç”¨åºåˆ—
    - âœ… é”™è¯¯å¤„ç†ï¼štry-catchåŒ…è£…å’Œè¯¦ç»†æ—¥å¿—
    - âœ… æ–‡ä»¶I/Oç®¡ç†ï¼šä¸´æ—¶ç›®å½•åˆ›å»ºå’Œæ¸…ç†

#### 2.3.2 é˜Ÿåˆ—æ¶æ„è®¾è®¡ âœ…

- [x] **BullMQé˜Ÿåˆ—é…ç½®** âœ… **å·²å®ç°**
  ```typescript
  // ContentJobModuleé…ç½®
  BullModule.registerQueue({
  	name: 'audio-generation',
  	defaultJobOptions: {
  		removeOnComplete: 10,
  		removeOnFail: 50,
  		delay: 1000,
  	},
  });
  ```

---

## ğŸ”— Milestone 3: BullMQä¸æ¨¡å—é›†æˆ âœ… **å·²å®Œæˆ**

**ğŸ¯ é›†æˆæˆæœ**: å®Œæ•´å®ç°äº†AIéŸ³é¢‘æœåŠ¡ä¸å¼‚æ­¥ä»»åŠ¡ç³»ç»Ÿçš„æ— ç¼é›†æˆï¼Œç¡®ä¿æ¨¡å—é—´çš„ä¾èµ–å…³ç³»å’Œæ•°æ®æµæ­£ç¡®ã€‚

### 3.1 æ¨¡å—ä¾èµ–æ¶æ„ âœ…

#### 3.1.1 AIAudioModuleè®¾è®¡ âœ…

- [x] **æ¨¡å—å¯¼å‡ºé…ç½®** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/ai-audio/ai-audio.module.ts`
  ```typescript
  @Module({
    imports: [ConfigModule],
    providers: [
      ElevenLabsProvider,
      ElevenLabsSoundscapeProvider,
      FFmpegAudioMixer,
      ASMRContentService,
    ],
    exports: [
      ElevenLabsProvider,
      ElevenLabsSoundscapeProvider,
      FFmpegAudioMixer,
      ASMRContentService,
    ],
  })
  ```

#### 3.1.2 ContentJobModuleé›†æˆ âœ…

- [x] **AIAudioModuleå¯¼å…¥** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/content-job/content-job.module.ts`
  - âœ… æ­£ç¡®å¯¼å…¥AIAudioModule
  - âœ… æ³¨å†ŒBullMQéŸ³é¢‘é˜Ÿåˆ—
  - âœ… é…ç½®AudioGenerationConsumer

#### 3.1.3 AppModuleæœ€ç»ˆé›†æˆ âœ…

- [x] **åº”ç”¨çº§åˆ«æ¨¡å—å¯¼å…¥** âœ… **å·²å®ç°**
  - æ–‡ä»¶è·¯å¾„ï¼š`apps/nestjs-backend/src/app.module.ts`
  - âœ… AIAudioModuleæ­£ç¡®å¯¼å…¥
  - âœ… BullMQ Redisé…ç½®
  - âœ… æ‰€æœ‰æ¨¡å—ä¾èµ–å…³ç³»å®Œæ•´

---

## ğŸ¯ å½“å‰å¼€å‘çŠ¶æ€æ€»ç»“

**ğŸ“Š é¡¹ç›®å®Œæˆåº¦**: âœ… **90%+ å®Œæˆï¼Œæ ¸å¿ƒASMRéŸ³é¢‘å¼•æ“å·²ç”Ÿäº§å°±ç»ª**

### âœ… å·²å®Œæˆçš„æ ¸å¿ƒåŠŸèƒ½

1. **ğŸ§ AIéŸ³é¢‘æ ¸å¿ƒå¼•æ“** âœ…
   - ElevenLabsè¯­éŸ³åˆæˆå®Œæ•´é›†æˆ
   - ElevenLabs Sound EffectséŸ³æ™¯ç”Ÿæˆï¼ˆæ›¿æ¢Soundverseï¼‰
   - FFmpegä¸“ä¸šéŸ³é¢‘æ··åˆå¤„ç†
   - ä¸­è€å¹´äººASMRä¸“é—¨ä¼˜åŒ–

2. **âš™ï¸ å¼‚æ­¥ä»»åŠ¡æ¶æ„** âœ…
   - BullMQä¸‰é˜Ÿåˆ—ç³»ç»Ÿ
   - é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
   - è¿›åº¦è·Ÿè¸ªå’ŒçŠ¶æ€ç®¡ç†

3. **ğŸ—ï¸ æ•°æ®æ¨¡å‹æ¶æ„** âœ…
   - æ‰€æœ‰æ ¸å¿ƒå®ä½“å®Œæ•´å®ç°
   - ASMRç‰¹å®šé…ç½®æ‰©å±•
   - æ•°æ®åº“è¿ç§»å’Œç´¢å¼•

4. **ğŸ”— æ¨¡å—é›†æˆ** âœ…
   - æ¨¡å—é—´ä¾èµ–å…³ç³»æ­£ç¡®
   - æœåŠ¡æ³¨å…¥å’Œé…ç½®å®Œæ•´
   - åº”ç”¨çº§åˆ«é›†æˆéªŒè¯

### âš ï¸ æŠ€æœ¯å€ºåŠ¡ï¼ˆå·²æœ€å°åŒ–ï¼‰

1. **é…ç½®æ–‡æ¡£** - éœ€è¦ç¯å¢ƒå˜é‡æ¸…å•å’Œé…ç½®æŒ‡å—ï¼ˆMediumï¼‰
2. **ç›‘æ§æŒ‡æ ‡** - éœ€è¦ä¸šåŠ¡æŒ‡æ ‡å’Œæ€§èƒ½ç›‘æ§ï¼ˆMediumï¼‰
3. **é›†æˆæµ‹è¯•** - éœ€è¦ç«¯åˆ°ç«¯æµ‹è¯•è¦†ç›–ï¼ˆLowï¼‰

### ğŸ“‹ å‰©ä½™åŠŸèƒ½æ¨¡å—ï¼ˆå¯é€‰æ‰©å±•ï¼‰

**ğŸ¯ å½“å‰çŠ¶æ€**: æ ¸å¿ƒASMRéŸ³é¢‘å¼•æ“å·²å®Œæˆï¼Œä»¥ä¸‹ä¸ºå¯é€‰æ‰©å±•åŠŸèƒ½æ¨¡å—ï¼Œå¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚ä¼˜å…ˆçº§è¿›è¡Œå¼€å‘ï¼š

## ğŸ“‚ æ‰©å±•æ¨¡å— A: ç´ æç®¡ç†ç³»ç»Ÿ (AssetModule)

**ä¼˜å…ˆçº§**: ä¸­ç­‰ | **é¢„è®¡å·¥æœŸ**: 2-3å‘¨ | **å¤æ‚åº¦**: ä¸­ç­‰

### A.1 æ–‡ä»¶ä¸Šä¼ å’Œç®¡ç†

- [ ] **å¤šåª’ä½“æ–‡ä»¶ä¸Šä¼ API**
  - æ”¯æŒå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘æ–‡ä»¶ä¸Šä¼ 
  - æ–‡ä»¶ç±»å‹éªŒè¯å’Œå¤§å°é™åˆ¶
  - è‡ªåŠ¨ç¼©ç•¥å›¾ç”Ÿæˆå’Œå…ƒæ•°æ®æå–
- [ ] **é˜¿é‡Œäº‘ç›˜é›†æˆ**
  - SDKé›†æˆå’Œæ–‡ä»¶å¯¼å…¥åŠŸèƒ½
  - äº‘ç«¯æ–‡ä»¶æµè§ˆå’Œæ‰¹é‡ä¸‹è½½
- [ ] **ç´ æåº“ç®¡ç†**
  - åˆ†é¡µæŸ¥è¯¢ã€é«˜çº§ç­›é€‰
  - æ ‡ç­¾ç®¡ç†å’Œæ‰¹é‡æ“ä½œ
  - ç´ æé¢„è§ˆå’Œè¯¦æƒ…æŸ¥çœ‹

### A.2 æŠ€æœ¯å®ç°è¦ç‚¹

```typescript
// AssetController æ ¸å¿ƒç«¯ç‚¹
POST /assets/upload        // æ–‡ä»¶ä¸Šä¼ 
POST /assets/import        // é˜¿é‡Œäº‘ç›˜å¯¼å…¥
GET  /assets              // ç´ æåˆ—è¡¨æŸ¥è¯¢
PATCH /assets/:id         // æ›´æ–°ç´ æä¿¡æ¯
DELETE /assets/:id        // åˆ é™¤ç´ æ
```

## ğŸ“ æ‰©å±•æ¨¡å— B: é¡¹ç›®ç®¡ç†ç³»ç»Ÿ (ProjectModule)

**ä¼˜å…ˆçº§**: ä¸­ç­‰ | **é¢„è®¡å·¥æœŸ**: 1-2å‘¨ | **å¤æ‚åº¦**: ç®€å•

### B.1 é¡¹ç›®ç»„ç»‡åŠŸèƒ½

- [ ] **é¡¹ç›®CRUDæ“ä½œ**
  - é¡¹ç›®åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤
  - é¡¹ç›®çŠ¶æ€ç®¡ç†
- [ ] **ç´ æå…³è”ç®¡ç†**
  - é¡¹ç›®ç´ ææ·»åŠ å’Œç§»é™¤
  - ç´ æä½¿ç”¨ç»Ÿè®¡

### B.2 æŠ€æœ¯å®ç°è¦ç‚¹

```typescript
// ProjectController æ ¸å¿ƒç«¯ç‚¹
POST /projects            // åˆ›å»ºé¡¹ç›®
GET  /projects           // é¡¹ç›®åˆ—è¡¨
GET  /projects/:id       // é¡¹ç›®è¯¦æƒ…
POST /projects/:id/assets // æ·»åŠ ç´ æåˆ°é¡¹ç›®
```

## ğŸ“‹ æ‰©å±•æ¨¡å— C: å†…å®¹æ¨¡æ¿ç³»ç»Ÿ (TemplateModule)

**ä¼˜å…ˆçº§**: ä½ | **é¢„è®¡å·¥æœŸ**: 1å‘¨ | **å¤æ‚åº¦**: ç®€å•

### C.1 æ¨¡æ¿ç®¡ç†åŠŸèƒ½

- [ ] **ASMRå†…å®¹æ¨¡æ¿**
  - é¢„ç½®ASMRéŸ³é¢‘æ¨¡æ¿
  - è‡ªå®šä¹‰æ¨¡æ¿åˆ›å»º
  - æ¨¡æ¿é…ç½®éªŒè¯

### C.2 é¢„ç½®æ¨¡æ¿ç±»å‹

```typescript
// ASMRéŸ³é¢‘æ¨¡æ¿ç¤ºä¾‹
const ASMRAudioTemplate = {
	name: 'èˆ’ç¼“ASMRéŸ³é¢‘æ¨¡æ¿',
	type: 'AUDIO_ONLY',
	slots: [
		{name: 'ä¸»éŸ³é¢‘', type: 'VOICE_AUDIO', required: true},
		{name: 'èƒŒæ™¯éŸ³æ™¯', type: 'SOUNDSCAPE_AUDIO', required: true},
		{name: 'æ··éŸ³é…ç½®', type: 'MIXING_CONFIG', required: false},
	],
	audioSettings: {
		format: 'wav',
		sampleRate: 44100,
		channels: 2,
		duration: 'auto',
	},
};
```

## ğŸš€ æ‰©å±•æ¨¡å— D: åˆ†å‘ä¸å‘å¸ƒç³»ç»Ÿ

**ä¼˜å…ˆçº§**: ä½ | **é¢„è®¡å·¥æœŸ**: 2-3å‘¨ | **å¤æ‚åº¦**: é«˜

### D.1 å¾®ä¿¡è§†é¢‘å·é›†æˆ

- [ ] **OAuth2æˆæƒæµç¨‹**
  - å¾®ä¿¡å¼€æ”¾å¹³å°é›†æˆ
  - æˆæƒç æ¢å–è®¿é—®ä»¤ç‰Œ
  - ä»¤ç‰Œåˆ·æ–°æœºåˆ¶

### D.2 å‘å¸ƒæ’æœŸç®¡ç†

- [ ] **å®šæ—¶å‘å¸ƒç³»ç»Ÿ**
  - å‘å¸ƒä»»åŠ¡è°ƒåº¦
  - æ‰¹é‡å‘å¸ƒç®¡ç†
  - å‘å¸ƒçŠ¶æ€è·Ÿè¸ª

---

## ğŸ”’ é™„åŠ åŠŸèƒ½: å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–

**ä¼˜å…ˆçº§**: ä¸­ç­‰ | **é¢„è®¡å·¥æœŸ**: 1-2å‘¨ | **å¤æ‚åº¦**: ä¸­ç­‰

### å®‰å…¨å¢å¼º

- [ ] **APIè®¿é—®é¢‘ç‡é™åˆ¶**
- [ ] **æ–‡ä»¶ä¸Šä¼ å®‰å…¨æ£€æŸ¥**
- [ ] **æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨**

### æ€§èƒ½ä¼˜åŒ–

- [ ] **æ•°æ®åº“æŸ¥è¯¢ç´¢å¼•ä¼˜åŒ–**
- [ ] **Redisç¼“å­˜ç­–ç•¥**
- [ ] **å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ä¼˜åŒ–**

---

## ğŸ“Š å¼€å‘ä¼˜å…ˆçº§å»ºè®®

### ğŸŸ¢ P0 (å·²å®Œæˆ) - æ ¸å¿ƒASMRéŸ³é¢‘å¼•æ“

- âœ… ElevenLabsè¯­éŸ³åˆæˆé›†æˆ
- âœ… ElevenLabs Sound EffectséŸ³æ™¯ç”Ÿæˆ
- âœ… FFmpegä¸“ä¸šéŸ³é¢‘æ··åˆå¤„ç†
- âœ… BullMQå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—
- âœ… ä¸­è€å¹´äººASMRä¼˜åŒ–

### ğŸŸ¡ P1 (å¯é€‰æ‰©å±•) - ä¸šåŠ¡åŠŸèƒ½å¢å¼º

- ğŸ“‚ ç´ æç®¡ç†ç³»ç»Ÿ (å¦‚éœ€è¦ä¸°å¯Œçš„åª’ä½“ç®¡ç†)
- ğŸ“ é¡¹ç›®ç®¡ç†ç³»ç»Ÿ (å¦‚éœ€è¦é¡¹ç›®ç»„ç»‡åŠŸèƒ½)

### ğŸ”µ P2 (æœªæ¥è§„åˆ’) - å¹³å°é›†æˆ

- ğŸš€ åˆ†å‘ä¸å‘å¸ƒç³»ç»Ÿ (å¦‚éœ€è¦è‡ªåŠ¨åŒ–å‘å¸ƒ)
- ğŸ”’ å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ– (ç”Ÿäº§ç¯å¢ƒå¿…éœ€)

---

## ğŸ¯ å½“å‰ç³»ç»Ÿèƒ½åŠ›æ€»ç»“

### âœ… å·²å®ç°çš„æ ¸å¿ƒèƒ½åŠ›

1. **ä¸“ä¸šASMRéŸ³é¢‘ç”Ÿæˆ**: ä»æ–‡æœ¬åˆ°é«˜è´¨é‡ASMRéŸ³é¢‘çš„å®Œæ•´å·¥ä½œæµ
2. **AIè¯­éŸ³åˆæˆ**: ElevenLabsé›†æˆï¼Œæ”¯æŒå¤šç§è¯­éŸ³å’ŒASMRä¼˜åŒ–å‚æ•°
3. **AIéŸ³æ™¯ç”Ÿæˆ**: ElevenLabs Sound Effects APIï¼Œæ”¯æŒåˆ†æ®µç”Ÿæˆå’Œæ— ç¼æ‹¼æ¥
4. **ä¸“ä¸šéŸ³é¢‘å¤„ç†**: FFmpegéŸ³é¢‘æ··åˆã€åŒè€³æ•ˆæœã€ASMRè´¨é‡ä¼˜åŒ–
5. **å¼‚æ­¥ä»»åŠ¡å¤„ç†**: BullMQé˜Ÿåˆ—ç³»ç»Ÿï¼Œæ”¯æŒé‡è¯•å’Œé”™è¯¯å¤„ç†
6. **ä¸­è€å¹´äººä¼˜åŒ–**: ä¸“é—¨çš„ASMRå‚æ•°è°ƒä¼˜å’Œå¬åŠ›å‹å¥½å¤„ç†

### ğŸ“ˆ ç³»ç»Ÿç‰¹ç‚¹

- **ç”Ÿäº§å°±ç»ª**: æ ¸å¿ƒå¼•æ“å·²è¾¾åˆ°å•†ä¸šåŒ–æ ‡å‡†
- **æ‰©å±•æ€§å¼º**: æ¨¡å—åŒ–æ¶æ„æ”¯æŒåŠŸèƒ½æ‰©å±•
- **è´¨é‡å¯æ§**: å®Œæ•´çš„éŸ³é¢‘è´¨é‡è¯„ä¼°å’Œä¼˜åŒ–ç³»ç»Ÿ
- **æˆæœ¬é€æ˜**: ç²¾ç¡®çš„AIæœåŠ¡æˆæœ¬ä¼°ç®—å’Œè·Ÿè¸ª

**ğŸ“‹ æ¨èä¸‹ä¸€æ­¥**: æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚ï¼Œé€‰æ‹©æ€§å®ç°æ‰©å±•æ¨¡å—ï¼Œæˆ–ç›´æ¥è¿›å…¥ç”Ÿäº§éƒ¨ç½²å’Œç”¨æˆ·æµ‹è¯•é˜¶æ®µã€‚

## ğŸ“Š æœ€æ–°çŠ¶æ€æ›´æ–° (2025-07-13)

### ğŸ¯ å½“å‰å¼€å‘çŠ¶æ€: **90%+ å®Œæˆï¼Œæ ¸å¿ƒASMRéŸ³é¢‘å¼•æ“å·²ç”Ÿäº§å°±ç»ª**

**Gemini 2.5 Proä¸“å®¶è¯„ä»·**:

> ç³»ç»Ÿå·²è¾¾åˆ°**å•†ä¸šçº§ASMRéŸ³é¢‘ç”Ÿæˆå¹³å°æ ‡å‡†**ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ä¸­è€å¹´äººçš„ä¼˜åŒ–å’ŒElevenLabs APIé›†æˆå®ç°ï¼Œå±•ç°äº†æ·±åº¦çš„é¢†åŸŸä¸“ä¸šçŸ¥è¯†ã€‚ç³»ç»Ÿå·²å‡†å¤‡å¥½ç”Ÿäº§éƒ¨ç½²ã€‚

### âœ… å·²å®Œæˆæ ¸å¿ƒèƒ½åŠ›

1. **ğŸ§ AIéŸ³é¢‘æ ¸å¿ƒå¼•æ“**: ElevenLabs + Sound Effects APIå®Œæ•´é›†æˆ
2. **âš™ï¸ å¼‚æ­¥ä»»åŠ¡æ¶æ„**: BullMQä¸‰é˜Ÿåˆ—ç³»ç»Ÿï¼Œå®Œæ•´é”™è¯¯å¤„ç†
3. **ğŸ—ï¸ æ•°æ®æ¨¡å‹æ¶æ„**: æ‰€æœ‰æ ¸å¿ƒå®ä½“ï¼ŒASMRé…ç½®æ‰©å±•
4. **ğŸ”— æ¨¡å—é›†æˆ**: æ¨¡å—é—´ä¾èµ–å…³ç³»æ­£ç¡®ï¼ŒæœåŠ¡æ³¨å…¥å®Œæ•´

### ğŸ“Š æŠ€æœ¯æŒ‡æ ‡

- **åŠŸèƒ½å®Œæ•´æ€§**: æ ¸å¿ƒASMRå¼•æ“100%ï¼Œæ‰©å±•æ¨¡å—å¯é€‰
- **ä»£ç è´¨é‡**: æ¶æ„æ¸…æ™°ï¼Œç±»å‹å®‰å…¨ï¼Œé”™è¯¯å¤„ç†å®Œå–„
- **ç”Ÿäº§å°±ç»ª**: å¯ç›´æ¥éƒ¨ç½²ï¼Œæ”¯æŒå•†ä¸šåŒ–ä½¿ç”¨

### ğŸ¯ å»ºè®®ç­–ç•¥

æ ¹æ®ä¸“å®¶åˆ†æï¼Œå½“å‰åç«¯å·²è¾¾åˆ°MVPæ ‡å‡†ï¼Œå»ºè®®ï¼š

1. **ä¼˜å…ˆå‰ç«¯å·¥ä½œæµå®Œå–„**: åç«¯èƒ½åŠ›å……è¶³ï¼Œä¸“æ³¨å‰ç«¯ç”¨æˆ·ä½“éªŒ
2. **å¯é€‰æ‰©å±•æ¨¡å—**: æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©æ€§å®ç°
3. **éƒ¨ç½²å‡†å¤‡**: å¯å¼€å§‹ç”Ÿäº§ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²æµç¨‹
