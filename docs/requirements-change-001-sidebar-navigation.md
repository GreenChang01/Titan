# 需求变更单 RCR-001: 侧边栏导航架构重构

## 变更基本信息

- **变更单号**: RCR-001
- **提出日期**: 2025-01-13
- **变更类型**: 功能增强
- **影响范围**: 前端导航架构、后端API扩展
- **优先级**: 高
- **提出人**: 产品团队
- **评估人**: 开发团队

## 变更背景与原因

### 当前问题

当前ASMR创作平台侧边栏导航设计过于简化，仅包含：

- 🏠 工作台 (Dashboard)
- ⚡ ASMR生成 (Generate)

这种设计无法支撑完整的ASMR创作工作流，缺失以下关键功能模块：

1. **提示词管理**: 文本内容模板库和分类管理
2. **项目管理**: 音频项目的组织和生命周期跟踪
3. **资源管理**: 语音预设、音景素材、文件管理
4. **成品管理**: 已生成音频的展示和管理
5. **任务监控**: 生成任务队列和进度跟踪

### 业务影响

- 用户无法有效组织和管理创作资源
- 缺乏项目全生命周期支持
- 重复配置导致效率低下
- 成品管理和分享功能缺失

## 需求变更详情

### 新导航架构设计

基于用户体验专家建议，采用扁平化、工作流导向的导航结构：

```
🏠 工作台 (Dashboard)
   └─ 项目概览、最近活动、快速访问、统计数据

🎙️ 开始创作 (Start Creating)
   └─ ASMR音频生成向导 (重命名优化UX)

🎨 我的创作 (My Creations)
   ├─ 进行中的项目
   ├─ 已完成的作品
   └─ 项目状态管理

📦 素材库 (Asset Library)
   ├─ 📝 文本模板 (Text Templates)
   ├─ 🎵 语音配置 (Voice Settings)
   ├─ 🌿 音景素材 (Soundscape Assets)
   └─ 📁 我的文件 (My Files)

⚙️ 任务中心 (Task Center)
   ├─ 生成任务监控
   ├─ 历史记录
   └─ 失败任务重试
```

### 核心设计理念

1. **用户工作流导向**: 合并"项目管理"和"成品库"为"我的创作"，符合线性创作思维
2. **认知负担最小化**: 统一所有创作素材到"素材库"，避免抽象分类
3. **中老年友好**: 使用直观动词替代技术术语

## 功能模块详细规格

### 1. 文本模板管理 (Templates)

**功能描述**: 提供预设文本模板库，支持分类管理和自定义创建
**后端支持**: ✅ ContentTemplate实体已存在
**主要功能**:

- 模板分类浏览 (睡前故事、冥想引导、正念练习)
- 自定义模板创建和编辑
- 公共模板库浏览
- 模板收藏和使用统计

### 2. 项目生命周期管理 (My Creations)

**功能描述**: 统一管理从创建到完成的整个项目生命周期
**后端支持**: ✅ Project、GeneratedContent实体已存在
**主要功能**:

- 项目创建和基本信息管理
- 进度状态跟踪 (草稿、进行中、已完成)
- 项目素材关联管理
- 成品播放、下载、分享

### 3. 语音预设库 (Voice Settings)

**功能描述**: ElevenLabs语音配置的模板化管理
**后端支持**: 🔄 需新建VoicePreset实体
**主要功能**:

- 语音参数模板保存 (稳定性、相似度、风格强度)
- 预设分类管理 (男性、女性、年龄群体)
- 语音试听和效果预览
- 使用频率统计

### 4. 音景素材库 (Soundscape Assets)

**功能描述**: 环境音效素材的管理和分类
**后端支持**: 🔄 需新建SoundscapeAsset实体
**主要功能**:

- 音景分类浏览 (自然、城市、白噪音)
- 自定义音景配置保存
- 音景试听和时长管理
- 音景与项目关联

### 5. 文件管理 (My Files)

**功能描述**: 阿里云盘WebDAV集成的文件管理
**后端支持**: ✅ 阿里云盘集成已完成
**主要功能**:

- 音频文件批量上传
- 文件分类和标签管理
- 版本控制和备份
- 存储空间监控

### 6. 任务中心 (Task Center)

**功能描述**: 音频生成任务的监控和管理
**后端支持**: ✅ ContentJob实体已存在
**主要功能**:

- 实时任务进度监控
- 任务队列状态显示
- 失败任务重试机制
- 历史任务记录查询

## 技术实现规格

### 前端开发任务

| 组件         | 文件路径                                | 开发工作量 | 依赖                |
| ------------ | --------------------------------------- | ---------- | ------------------- |
| 侧边栏重构   | `src/components/layout/app-sidebar.tsx` | 2天        | 图标库更新          |
| 文本模板页面 | `src/app/[locale]/templates/`           | 5天        | ContentTemplate API |
| 项目管理页面 | `src/app/[locale]/projects/`            | 8天        | Project API重构     |
| 语音预设页面 | `src/app/[locale]/voice-presets/`       | 4天        | 新VoicePreset API   |
| 音景素材页面 | `src/app/[locale]/soundscapes/`         | 4天        | 新Soundscape API    |
| 任务中心页面 | `src/app/[locale]/tasks/`               | 3天        | ContentJob API      |

### 后端开发任务

| 实体/API            | 开发工作量 | 描述                   |
| ------------------- | ---------- | ---------------------- |
| VoicePreset实体     | 2天        | 语音配置模板管理       |
| SoundscapeAsset实体 | 2天        | 音景素材管理           |
| Project API扩展     | 3天        | 状态管理和关联查询优化 |
| ContentTemplate API | 1天        | 分类和搜索功能增强     |
| 权限控制更新        | 2天        | 新模块的访问权限设计   |

### 数据库迁移

```sql
-- VoicePreset表
CREATE TABLE voice_preset (
    id UUID PRIMARY KEY,
    user_id UUID NOT NULL,
    name VARCHAR(255) NOT NULL,
    voice_id VARCHAR(255) NOT NULL,
    stability DECIMAL(3,2) DEFAULT 0.85,
    similarity DECIMAL(3,2) DEFAULT 0.90,
    style DECIMAL(3,2) DEFAULT 0.10,
    speaker_boost BOOLEAN DEFAULT true,
    category VARCHAR(100),
    is_public BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- SoundscapeAsset表
CREATE TABLE soundscape_asset (
    id UUID PRIMARY KEY,
    user_id UUID NOT NULL,
    name VARCHAR(255) NOT NULL,
    category VARCHAR(100) NOT NULL,
    file_path VARCHAR(500),
    duration INTEGER,
    description TEXT,
    tags JSON,
    is_public BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

## 用户体验改进

### 中老年用户优化

1. **视觉设计**:
   - 图标尺寸放大至24px
   - 字体大小提升至16px
   - 高对比度色彩方案

2. **交互优化**:
   - 减少嵌套层级 (最多2层)
   - 提供面包屑导航
   - 关键操作确认对话框

3. **术语优化**:
   - "开始创作" 替代 "ASMR生成"
   - "我的创作" 替代 "项目管理"
   - "素材库" 替代 "资源中心"

### 操作流程简化

- 常用功能一键访问
- 模板化操作减少重复配置
- 智能推荐基于使用历史

## 验收标准

### 功能验收

- [ ] 新导航结构完整实现
- [ ] 所有模块页面正常访问
- [ ] 数据持久化正确
- [ ] 权限控制有效

### 性能验收

- [ ] 页面加载时间 < 2秒
- [ ] 大文件上传支持断点续传
- [ ] 并发任务处理稳定

### 用户体验验收

- [ ] 中老年用户可用性测试通过
- [ ] 操作流程符合用户习惯
- [ ] 错误提示友好清晰

## 风险评估与缓解

### 技术风险

- **风险**: 新实体设计可能影响现有API
- **缓解**: 向后兼容设计，渐进式迁移

### 用户接受度风险

- **风险**: 导航结构变更可能影响用户习惯
- **缓解**: 提供新手引导和过渡期支持

### 开发风险

- **风险**: 前后端协调复杂度高
- **缓解**: 详细API设计文档，增量开发验证

## 实施计划

### 阶段1: 基础架构 (Week 1-2)

- 后端新实体设计和数据库迁移
- 侧边栏组件重构
- 基础路由和页面框架

### 阶段2: 核心功能 (Week 3-5)

- 文本模板管理完整实现
- 项目生命周期管理
- 语音预设和音景素材基础功能

### 阶段3: 优化完善 (Week 6-7)

- 任务中心监控功能
- 用户体验优化
- 性能调优和测试

### 阶段4: 测试发布 (Week 8)

- 集成测试和用户验收测试
- 生产环境部署
- 用户培训和文档更新

## 变更批准

- **产品负责人**: **\*\*\*\***\_**\*\*\*\*** 日期: \***\*\_\*\***
- **技术负责人**: **\*\*\*\***\_**\*\*\*\*** 日期: \***\*\_\*\***
- **设计负责人**: **\*\*\*\***\_**\*\*\*\*** 日期: \***\*\_\*\***

---

**变更状态**: 待审批
**最后更新**: 2025-01-13
**文档版本**: v1.0
